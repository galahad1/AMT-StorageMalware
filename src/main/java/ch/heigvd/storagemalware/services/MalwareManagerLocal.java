package ch.heigvd.storagemalware.services;


import ch.heigvd.storagemalware.models.Malware;

import javax.ejb.Local;
import java.util.List;

/**
 * DAO to interact with the database
 *
 * @author Tano Iannetta and Wojciech Myszkorowski
 * @see MalwareManager
 */
@Local
public interface MalwareManagerLocal {


    /**
     * Get a malware in the database
     *
     * @param id of the malware to get
     * @return malware from the database
     */
    Malware getMalware(Long id);

    /**
     * Get all the malwares
     *
     * @return list of the malware
     */
    List<Malware> getAllMalware();


    /**
     * Get a number wanted of malware which begins from an offset
     *
     * @param limit  number of malware wanted
     * @param offset offset of the first malware of the list
     * @return list of malware
     */
    List<Malware> getSomeMalware(int limit, int offset);

    /**
     * Store a malware in the database
     *
     * @param malware to store
     */
    void storeMalware(Malware malware);

    /**
     * Store a list of malware in the database
     *
     * @param malwareList list to store
     */
    void storeListMalware(List<Malware> malwareList);

    /**
     * Update the values of a malware given by his id
     *
     * @param id       of the malware to update
     * @param name     new name
     * @param hash     new hash
     * @param category new category
     * @param date     new date
     */
    void updateMalware(Long id, String name, String hash, String category, String date);

    /**
     * Delete a malware from the database
     *
     * @param id id of malware to delete
     */
    void deleteMalware(Long id);

    /**
     * Get the number of entries in the database
     *
     * @return number of entries
     */
    int getSizeDB();

    /**
     * Get the password of an account
     *
     * @param email of the account
     * @return password
     */
    String getPass(String email);
}
